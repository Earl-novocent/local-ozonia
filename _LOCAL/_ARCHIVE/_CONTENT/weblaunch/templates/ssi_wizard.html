<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><!-- saved from url=(0089)http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html --><HTML><HEAD><TITLE>SSI WIZARD</TITLE><META http-equiv=Content-Type content="text/html; charset=windows-1252"><STYLE type=text/css>P {	FONT-SIZE: 10pt; FONT-FAMILY: verdana}TABLE {	FONT-SIZE: 10pt; FONT-FAMILY: verdana}SELECT {	FONT-SIZE: 10pt; FONT-FAMILY: verdana}INPUT {	FONT-SIZE: 10pt; FONT-FAMILY: verdana}TH {	TEXT-ALIGN: left}A {	TEXT-DECORATION: none}#submitted {	DISPLAY: none}</STYLE><SCRIPT language=javascript><!--// global vars:var advanced_on = 0; // toggle advanced menu visibilityvar search_url = 'http://www.ozonia.com/cgi/artman/exec/search.cg';var search_link; /* ---------------------------------------------------------------------- *\  Function    : generate()  Description : 1. Creates the SSI and writes it to the document for use,	              2. Creates a text search.cgi script to verify the query 								   is accurate. \* ---------------------------------------------------------------------- */function generate() {  var x = validate_form(); 	if (!x)  { return false; }   var SSI_string = '';  a = document.ssi_wizard;		var s = '';	if (a.start.value != "1") { s = "start=" + a.start.value;	}  SSI_string += s;	var p = '';  if (s) { p = "&perpage=" + a.perpage.value; }   else { p = "perpage=" + a.perpage.value; }	SSI_string += p;		if (a.template.value) { 	  SSI_string += "&template=" + a.template.value;	}	  if (a.cat.value) {	  SSI_string += "&cat=" + a.cat.value;  }		  s = '';	  // Keywords. Search "all" 	if (a.keyword.value && a.key[0].checked) {		var s = "&fields=art_field1,summary,content&keyword=" + a.keyword.value;	}	t = '';  // Keywords. Search specific fields 	if (a.keyword_specific.value && a.key[1].checked) {    for (i=0; i<a.keyword_fields.length; i++) {		  if (a.keyword_fields.options[i].selected) { 			  if (a.keyword_fields.options[i].value == 'caption') {				  t += "caption1,caption2,caption3,caption4,caption5,caption6,caption7,caption8,"					   + "caption9,caption10,caption11,caption12,caption13,caption14,caption15,caption16,"					   + "caption17,caption18,caption19,caption20,caption21,caption22,caption23,caption23,"					   + "caption24,caption25,";				}				else {   			  t += a.keyword_fields.options[i].value + ",";				}			}		}		if (t) { 			t = t.substring(0, t.length-1);		  var s = "&fields=" + t + "&keyword=" + a.keyword_specific.value;		}	}		  SSI_string += encodeURI(s);		// date range: FROM	if (a.mon.value && a.day.value 	  && a.year.value) {      SSI_string += "&mon=" + a.mon.value + "&day=" 			    + a.day.value + "&year=" 					+ a.year.value;	}	// date range: TO	if (a.mon2.value && a.day2.value && a.year2.value) {      SSI_string += "&mon2=" + a.mon2.value + "&day2=" 			    + a.day2.value + "&year2=" 					+ a.year2.value;	}		if (a.archive.value) { 	  SSI_string += "&archive=" + a.archive.value;	}		// Here we put together our two SSIs and the search query string.	// 1. extract webroot path   var temp = search_url.split("http:\/\/");  i = temp[1].indexOf('\/');	webroot_search = temp[1].substring(i, temp[1].length);	// 2. Create server-dependent SSIs 	Unix_SSI = "<!--#include virtual=\"" + webroot_search + "?" + SSI_string + "\"-->";	Windows_SSI = "<!--#exec cgi=\"" + webroot_search + "?" + SSI_string + "\"-->";	document.getElementById('unix_ssi').value = String(Unix_SSI);	document.getElementById('windows_ssi').value = Windows_SSI;	document.getElementById('query_string').value = SSI_string;	search_link = search_url + "?" + SSI_string;		  document.getElementById('submitted').style.display = "block";	  	}/* ---------------------------------------------------------------------- *\  Function    : validate_form()  Description : helper function to verify the input information is valid\* ---------------------------------------------------------------------- */function validate_form() {   a = document.ssi_wizard;	  // start # is a NUMBER.	if (a.start.value.search(/\D/) != -1) { 	  alert("Start Number should only contain digits.");		a.start.focus();		a.start.select();		a.start.style.backgroundColor = "#FF6633";			  return false;	}  if (a.start.value == '0') {    alert("Start Number can't be zero - only 1+");		a.start.focus();		a.start.select();		a.start.style.backgroundColor = "#FF6633";			  return false;	}		// perpage is a NUMBER.	if (a.perpage.value.search(/\D/) != -1) { 	  alert("Number of Articles per page should only contain digits.");		a.perpage.focus();		a.perpage.select();		a.perpage.style.backgroundColor = "#FF6633";			  return false;	}		// remove "/" prefix on template values.   var tmp = a.template.value;  if (tmp.charAt(0) == "/") { tmp = tmp.substring(1,tmp.length); }	a.template.value = tmp;  return true;	}/* ---------------------------------------------------------------------- *\  Function    : attention()  Description : updates the selected radio button if user starts entering	              in values for keyword fields\* ---------------------------------------------------------------------- */function attention(f) {  a = document.ssi_wizard;	  if (f == 'key_all' && a.key[1].checked) {    a.key[0].checked = true;	}  if (f == 'key_spec' && a.key[0].checked) {    a.key[1].checked = true;	}	}/* ---------------------------------------------------------------------- *\  Function    : popup()  Description : help popup for each input option\* ---------------------------------------------------------------------- */function popup(message) {  switch(message) {	  case "type": 		  alert("This dropdown allows you to specify the "	        + "category you wish your articles to be drawn from.\nYou can choose either "		      + "one or all categories. If you wish to select a GROUP of categories,\nyou "       		+ "would have use separate SSIs for each."); 			break;	  case "start": 		  alert("All Article Manager search engine SSIs pull "	        + "in the \'n\' most recent articles.\nThis variable allows you to start "		      + "pulling in articles from the \'nth\' most recent on."); 			break;	  case "perpage": 			alert("This allows you to specify the number of "	        + "articles which appear per page in your\nsearch results SSI."); 			break;		case "template":      alert("This textbox allows you to specify a "	        + "particular template to return the results with.\nIf this field is left "      		+ "blank, it will use the default template (search/_search_results.html)\n"		      + "to return the result with.\n\nThe search engine looks for a template in "      		+ "your /templates directory.So, if you're storing\nyour custom template "		      + "in a subdirectory, be sure to specify this; e.g.\n"      		+ "search/my_custom_template.html");			break;		case "keyword":		  alert("This field allows you to create searches based on a predefined "			    + "keyword or keywords.\nNote: this only searches the most relevant "					+ "aspects of your Article Manager database - \nthe article summaries, "					+ "article contents, and the names of the writers.");			break; 	  case "keyword_specific":		  alert("This field allows you to pinpoint "	        + "precisely which field you want the \nSSI to return. the number of "      	  + "articles which appear per page in your\nsearch results SSI."); 			break;	  case "date_search":		  alert("This allows you to return a range of articles by their date. "      	  + "If you\nwish to choose the same day, set the two dates to be the same."); 			break;	  case "archive":		  alert("This allows you to create an SSI which queries a particular archive. "			    + "By default,\nit will search the current articles.");			break;	  case "windows_ssi":		  alert("This is the SSI you will need to use if you are running a Windows-based "			    + "server.\n\nTip: if you're not sure what server you're running, try "					+ "changing the case of any character in the address bar of a page on "					+ "your website. If the page still loads up, you're using a Windows "					+ "server. If it fails to load, you are running a Unix server!");			break;	  case "unix_ssi":		  alert("This is the SSI you will need to use if you are running a Unix-based "			    + "server.\n\nTip: if you're not sure what server you're running, try "					+ "changing the case of any character in the address bar of a page on "					+ "your website. If the page still loads up, you're using a Windows "					+ "server. If it fails to load, you are running a Unix server!");			break;	  case "test":		  alert("This links directly to your search script. After creating an SSI, "  			  + "you can use this to verify the search returns precisely what you "					+ "want, BEFORE embedding the SSI in your page!");			break;  }	}//--></SCRIPT><META content="MSHTML 6.00.2800.1276" name=GENERATOR></HEAD><BODY bgColor=#fefce9 leftMargin=0 topMargin=0><TABLE height=60 cellSpacing=0 cellPadding=5 width="100%" bgColor=#660000>  <TBODY>  <TR>    <TD vAlign=bottom align=middle>      <TABLE width=550>        <TBODY>        <TR>          <TD><FONT color=white size=+1><B>SSI WIZARD</FONT>&nbsp; <FONT             color=#cccccc size=+1><I>for Article Manager</I></FONT></B>&nbsp;         </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><TABLE width=550 align=center>  <TBODY>  <TR>    <TD>      <FORM name=ssi_wizard><BR>      <P>This script automatically creates Article Manager SSIs for you. Just       choose the options below, then click "Generate SSI"!</P>      <TABLE       style="BORDER-RIGHT: #666 1px solid; BORDER-TOP: #666 1px solid; BORDER-LEFT: #666 1px solid; BORDER-BOTTOM: #666 1px solid"       width=550>        <TBODY>        <TR bgColor=#cccc99>          <TD align=middle width=25><FONT size=+1><A onclick="popup('type')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#">?</A>             </FONT></TD>          <TH width=200>&nbsp;Category</TH>          <TD><SELECT name=cat> <OPTION selected>All Categories</OPTION>               <OPTION value=5>Entertainment<OPTION value=2>National News<OPTION               value=3>World News<OPTION value=1>Business<OPTION               value=4>Sports</OPTION></SELECT></TD></TR>        <TR bgColor=#ece9cd>          <TD align=middle width=25><FONT size=+1><A onclick="popup('start')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#">?</A>             </FONT></TD>          <TH>&nbsp;Start Number</TH>          <TD><INPUT type=textbox size=2 value=1 name=start> </TD></TR>        <TR bgColor=#cccc99>          <TD align=middle width=25><FONT size=+1><A             onclick="popup('perpage')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#">?</A>             </FONT></TD>          <TH>&nbsp;No. articles per page</TH>          <TD><INPUT type=textbox size=2 value=5 name=perpage></TD></TR>        <TR bgColor=#ece9cd>          <TD align=middle width=25><FONT size=+1><A             onclick="popup('template')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#">?</A>             </FONT></TD>          <TH>&nbsp;Template</TH>          <TD><INPUT type=textbox size=40       name=template></TD></TR></TBODY></TABLE><BR>      <TABLE       style="BORDER-RIGHT: #666 1px solid; BORDER-TOP: #666 1px solid; BORDER-LEFT: #666 1px solid; BORDER-BOTTOM: #666 1px solid"       width=550>        <TBODY>        <TR bgColor=#cccc99>          <TD align=middle width=25><FONT size=+1><A             onclick="popup('keyword')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#">?</A>             </FONT></TD>          <TH width=200><INPUT type=radio CHECKED value=key_all             name=key>Keyword</TH>          <TD><INPUT onclick="attention('key_all');" type=textbox           name=keyword></TD></TR>        <TR bgColor=#ece9cd>          <TD align=middle width=25><FONT size=+1><A             onclick="popup('keyword_specific')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#">?</A>             </FONT></TD>          <TH><INPUT type=radio value=key_spec name=key>Keyword (specific             fields)</TH>          <TD vAlign=center>            <TABLE cellSpacing=0 cellPadding=0>              <TBODY>              <TR>                <TD><INPUT onclick="attention('key_spec');" type=textbox                   name=keyword_specific>&nbsp;&nbsp; </TD>                <TD><SELECT multiple size=4 name=keyword_fields> <OPTION                     value=art_field1>Name</OPTION> <OPTION                     value=summary>Summary</OPTION> <OPTION                     value=content>Content</OPTION> <OPTION value=caption>Image                     Captions</OPTION> <OPTION                     value=art_field2>art_field2</OPTION> <OPTION                     value=art_field3>art_field3&nbsp;&nbsp;</OPTION><OPTION                     value=art_field4>art_field4</OPTION> <OPTION                     value=art_field5>art_field5&nbsp;&nbsp;</OPTION><OPTION                     value=art_field6>art_field6</OPTION> <OPTION                     value=art_field7>art_field7&nbsp;&nbsp;</OPTION><OPTION                     value=art_field8>art_field8</OPTION> <OPTION                     value=art_field9>art_field9&nbsp;&nbsp;</OPTION><OPTION                     value=art_field10>art_field10</OPTION> <OPTION                     value=art_field11>art_field11&nbsp;&nbsp;</OPTION><OPTION                     value=art_field12>art_field12</OPTION> <OPTION                     value=art_field13>art_field13&nbsp;&nbsp;</OPTION><OPTION                     value=art_field14>art_field14</OPTION> <OPTION                     value=art_field15>art_field15&nbsp;&nbsp;</OPTION><OPTION                     value=art_field16>art_field16</OPTION> <OPTION                     value=art_field17>art_field17&nbsp;&nbsp;</OPTION><OPTION                     value=art_field18>art_field18</OPTION> <OPTION                     value=art_field19>art_field19</OPTION></SELECT>             </TD></TR></TBODY></TABLE></TD></TR>        <TR bgColor=#cccc99>          <TD align=middle width=25><FONT size=+1><A             onclick="popup('date_search')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#">?</A>             </FONT></TD>          <TH width=150>&nbsp;Date search</TH>          <TD>            <TABLE>              <TBODY>              <TR>                <TD width=70>Between</TD>                <TD><SELECT name=mon> <OPTION value="" selected>mon<OPTION                     value=1>Jan<OPTION value=2>Feb<OPTION value=3>Mar<OPTION                     value=4>Apr<OPTION value=5>May<OPTION value=6>Jun<OPTION                     value=7>Jul<OPTION value=8>Aug<OPTION value=9>Sep<OPTION                     value=10>Oct<OPTION value=11>Nov<OPTION                   value=12>Dec</OPTION></SELECT> <SELECT name=day> <OPTION                     value="" selected>day<OPTION value=1>1<OPTION                     value=2>2<OPTION value=3>3<OPTION value=4>4<OPTION                     value=5>5<OPTION value=6>6<OPTION value=7>7<OPTION                     value=8>8<OPTION value=9>9<OPTION value=10>10<OPTION                     value=11>11<OPTION value=12>12<OPTION value=13>13<OPTION                     value=14>14<OPTION value=15>15<OPTION value=16>16<OPTION                     value=17>17<OPTION value=18>18<OPTION value=19>19<OPTION                     value=20>20<OPTION value=21>21<OPTION value=22>22<OPTION                     value=23>23<OPTION value=24>24<OPTION value=25>25<OPTION                     value=26>26<OPTION value=27>27<OPTION value=28>28<OPTION                     value=29>29<OPTION value=30>30<OPTION                   value=31>31</OPTION></SELECT> <SELECT name=year> <OPTION                     value="" selected>year<OPTION value=1980>1980<OPTION                     value=1981>1981<OPTION value=1982>1982<OPTION                     value=1983>1983<OPTION value=1984>1984<OPTION                     value=1985>1985<OPTION value=1986>1986<OPTION                     value=1987>1987<OPTION value=1988>1988<OPTION                     value=1989>1989<OPTION value=1990>1990<OPTION                     value=1991>1991<OPTION value=1992>1992<OPTION                     value=1993>1993<OPTION value=1994>1994<OPTION                     value=1995>1995<OPTION value=1996>1996<OPTION                     value=1997>1997<OPTION value=1998>1998<OPTION                     value=1999>1999<OPTION value=2000>2000<OPTION                     value=2001>2001<OPTION value=2002>2002<OPTION                     value=2003>2003<OPTION value=2004>2004<OPTION                     value=2005>2005<OPTION value=2006>2006<OPTION                     value=2007>2007<OPTION value=2008>2008<OPTION                     value=2009>2009<OPTION value=2010>2010<OPTION                     value=2011>2011<OPTION value=2012>2012<OPTION                     value=2013>2013<OPTION value=2014>2014<OPTION                     value=2015>2015<OPTION value=2016>2016<OPTION                     value=2017>2017<OPTION value=2018>2018<OPTION                     value=2019>2019<OPTION value=2020>2020<OPTION                     value=2021>2021<OPTION value=2022>2022<OPTION                     value=2023>2023<OPTION value=2024>2024</OPTION></SELECT> </TD></TR>              <TR>                <TD>and</TD>                <TD><SELECT name=mon2> <OPTION value="" selected>mon<OPTION                     value=1>Jan<OPTION value=2>Feb<OPTION value=3>Mar<OPTION                     value=4>Apr<OPTION value=5>May<OPTION value=6>Jun<OPTION                     value=7>Jul<OPTION value=8>Aug<OPTION value=9>Sep<OPTION                     value=10>Oct<OPTION value=11>Nov<OPTION                   value=12>Dec</OPTION></SELECT> <SELECT name=day2> <OPTION                     value="" selected>day<OPTION value=1>1<OPTION                     value=2>2<OPTION value=3>3<OPTION value=4>4<OPTION                     value=5>5<OPTION value=6>6<OPTION value=7>7<OPTION                     value=8>8<OPTION value=9>9<OPTION value=10>10<OPTION                     value=11>11<OPTION value=12>12<OPTION value=13>13<OPTION                     value=14>14<OPTION value=15>15<OPTION value=16>16<OPTION                     value=17>17<OPTION value=18>18<OPTION value=19>19<OPTION                     value=20>20<OPTION value=21>21<OPTION value=22>22<OPTION                     value=23>23<OPTION value=24>24<OPTION value=25>25<OPTION                     value=26>26<OPTION value=27>27<OPTION value=28>28<OPTION                     value=29>29<OPTION value=30>30<OPTION                   value=31>31</OPTION></SELECT> <SELECT name=year2> <OPTION                     value="" selected>year<OPTION value=1980>1980<OPTION                     value=1981>1981<OPTION value=1982>1982<OPTION                     value=1983>1983<OPTION value=1984>1984<OPTION                     value=1985>1985<OPTION value=1986>1986<OPTION                     value=1987>1987<OPTION value=1988>1988<OPTION                     value=1989>1989<OPTION value=1990>1990<OPTION                     value=1991>1991<OPTION value=1992>1992<OPTION                     value=1993>1993<OPTION value=1994>1994<OPTION                     value=1995>1995<OPTION value=1996>1996<OPTION                     value=1997>1997<OPTION value=1998>1998<OPTION                     value=1999>1999<OPTION value=2000>2000<OPTION                     value=2001>2001<OPTION value=2002>2002<OPTION                     value=2003>2003<OPTION value=2004>2004<OPTION                     value=2005>2005<OPTION value=2006>2006<OPTION                     value=2007>2007<OPTION value=2008>2008<OPTION                     value=2009>2009<OPTION value=2010>2010<OPTION                     value=2011>2011<OPTION value=2012>2012<OPTION                     value=2013>2013<OPTION value=2014>2014<OPTION                     value=2015>2015<OPTION value=2016>2016<OPTION                     value=2017>2017<OPTION value=2018>2018<OPTION                     value=2019>2019<OPTION value=2020>2020<OPTION                     value=2021>2021<OPTION value=2022>2022<OPTION                     value=2023>2023<OPTION value=2024>2024</OPTION></SELECT>               </TD></TR></TBODY></TABLE></TD></TR>        <TR bgColor=#ece9cd>          <TD align=middle width=25><FONT size=+1><A             onclick="popup('archive')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#">?</A>             </FONT></TD>          <TH width=150>&nbsp;Archive</TH>          <TD><SELECT name=archive> <OPTION value="" selected>Current               Articles</OPTION></SELECT> </TD></TR></TBODY></TABLE><BR><INPUT onclick=javascript:generate(); type=button value="Generate SSI">       <BR><BR>      <DIV id=submitted>      <TABLE       style="BORDER-RIGHT: #660000 1px solid; BORDER-TOP: #660000 1px solid; BORDER-LEFT: #660000 1px solid; BORDER-BOTTOM: #660000 1px solid"       width="100%">        <TBODY>        <TR bgColor=#cccc66>          <TD align=middle width=25><FONT size=+1><A             onclick="popup('unix_ssi')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#">?</A>             </FONT></TD>          <TH width=150>Unix-based SSI:</TH>          <TD><INPUT id=unix_ssi size=50 name=unix_ssi></TEXTAREA></TD></TR>        <TR bgColor=#cccc66>          <TD align=middle width=25><FONT size=+1><A             onclick="popup('windows_ssi')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#">?</A>             </FONT></TD>          <TH width=150>Windows-based SSI:</TH>          <TD><INPUT id=windows_ssi type=textbox size=50         name=windows_ssi></TD></TR>        <TR bgColor=#cccc66>          <TD align=middle width=25><FONT size=+1><A onclick="popup('')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#"></A></FONT></TD>          <TH width=150>Query String:</TH>          <TD><INPUT id=query_string type=textbox size=50         name=query_string></TD></TR>        <TR bgColor=#cccc66>          <TD align=middle width=25><FONT size=+1><A onclick="popup('test')"             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#">?</A>             </FONT></TD>          <TH width=150>Test:</TH>          <TD><A onclick=window.open(search_link);             href="http://www.interactivetools.com/staff/ben/artman/exec/search.cgi?template=ssi_wizard.html#"><U>Click             here to test your search       query</U></A></TD></TD></TR></TBODY></TABLE></DIV></FORM>      <HR>      <FONT size=0>How can we improve this script? Send your comments to <A       href="mailto:info@interactivetools.com">interactivetools.com</A></FONT>       <BR><BR><BR><BR></TD></TR></TBODY></TABLE></BODY></HTML>