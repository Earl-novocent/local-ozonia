<?php$uploadDir = '';if ($_SERVER['REQUEST_METHOD']=='POST'){	if (isset($_FILES['file'])&&$_FILES['file']['name']&&!$_FILES['file']['error'])	{		$file = $_FILES['file'];		$size = @getimagesize($file['tmp_name']);		if ($size!==false)		{			if ($size[2]!=IMAGETYPE_JPEG)			{				echo "The file is not a jpeg image";			}			else			{				$name = $file['name'];				$base = strrpos($name,'.')>0?substr($name,0,strrpos($name,'.')):$name;								if (!@move_uploaded_file($file['tmp_name'],$uploadDir.$file['name']))				{					echo "The file couldn't be uploaded";				}				else				{					$succes = resize($uploadDir.$file['name']);										if ($succes)					{					?><img src="<?php echo $base;?>_tn.jpeg" alt="thumbnail" /><img src="<?php echo $base;?>_sm.jpeg" alt="small image" /><img src="<?php echo $base;?>_lg.jpeg" alt="large image" />					<?php					}					else					{						echo "The image couldn't be resized";					}				}			}		}		else		{			echo "The file isn't an image";		}	}	else	{		echo "The file couldn't be uploaded";	}}?><?phpfunction resize($image = 'im.jpeg'){	$filename = basename($image);	$base     = strrpos($filename,'.')>0?substr($filename,0,strrpos($filename,'.')):$filename;	$size     = @getimagesize($image);		if ($size!==false)	{		if ($size[2]!=IMAGETYPE_JPEG)		{			return false;		}				$t1 = max($size[0]/75,$size[1]/75);		$t2 = max($size[0]/200,$size[1]/200);		$t3 = max($size[0]/350,$size[1]/350);		$src = @imagecreatefromjpeg($image);				if ($src)		{			$dest1 = imagecreatetruecolor((int)($size[0]/$t1),(int)($size[1]/$t1));			imagecopyresized($dest1,$src,0,0,0,0,(int)($size[0]/$t1),(int)($size[1]/$t1),$size[0],$size[1]);						if (!imagejpeg($dest1,$base.'_tn.jpeg'))			{				return false;			}						imagedestroy($dest1);			$dest2 = imagecreatetruecolor((int)($size[0]/$t2),(int)($size[1]/$t2));			imagecopyresized($dest2,$src,0,0,0,0,(int)($size[0]/$t2),(int)($size[1]/$t2),$size[0],$size[1]);						if (!imagejpeg($dest2,$base.'_sm.jpeg'))			{				return false;			}						imagedestroy($dest2);			$dest3 = imagecreatetruecolor((int)($size[0]/$t3),(int)($size[1]/$t3));			imagecopyresized($dest3,$src,0,0,0,0,(int)($size[0]/$t3),(int)($size[1]/$t3),$size[0],$size[1]);						if (!imagejpeg($dest3,$base.'_lg.jpeg'))			{				return false;			}						imagedestroy($dest3);			imagedestroy($src);			return true;		}		else		{			return false;		}	}	else	{		return false;	}}?>